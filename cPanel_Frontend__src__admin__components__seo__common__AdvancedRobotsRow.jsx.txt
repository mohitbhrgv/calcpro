import React from "react";

/**
 * AdvancedRobotsRow
 * 
 * Handles advanced SEO meta tags like max-snippet, max-video-preview, and max-image-preview.
 * 
 * Inheritance Logic:
 * - disabled={true}: Reads values from "seo_robots_global_" prefix. Inputs are locked.
 * - disabled={false}: Reads/Writes values from the specific local `prefix`.
 */
const AdvancedRobotsRow = ({ settings, prefix, onChange, disabled = false }) => {
  
  // 1. Determine Read Source
  const readPrefix = disabled ? "seo_robots_global_" : prefix;

  // 2. Logic to handle updates (Always writes to Local prefix)
  const handleInputChange = (key, val) => {
    if (disabled) return; // Prevent edits if locked
    onChange({ target: { name: `${prefix}${key}`, value: val } });
  };

  // 3. Dependency Check
  // If "No Snippet" is active (either globally or locally depending on mode), 
  // these specific advanced settings become irrelevant/disabled.
  const isNoSnippetActive = settings[`${readPrefix}nosnippet`] === true;
  const isInputDisabled = disabled || isNoSnippetActive;

  return (
    <div className={`flex flex-col md:flex-row md:gap-8 py-6 border-b border-gray-100 dark:border-gray-700 transition-opacity duration-300 ${disabled ? 'opacity-60 grayscale' : ''}`}>
      <div className="w-full md:w-1/4 pt-1">
        <label className="block text-sm font-semibold text-gray-800 dark:text-gray-200">
          Advanced Robots Meta
        </label>
        <p className="text-xs text-gray-500 mt-1">
          {disabled 
            ? "Inheriting advanced rules from Global Settings." 
            : "Fine-tune snippet limits for this specific section."}
        </p>
      </div>
      <div className="w-full md:w-3/4">
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
            {/* Max Snippet */}
            <div>
                <label className="block text-xs font-medium text-gray-500 mb-1">Snippet (max-chars)</label>
                <input 
                    type="number" 
                    value={settings[`${readPrefix}max_snippet`] ?? -1}
                    onChange={(e) => handleInputChange('max_snippet', e.target.value)}
                    disabled={isInputDisabled}
                    className={`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm dark:bg-gray-700 dark:text-white ${isInputDisabled ? 'bg-gray-100 dark:bg-gray-800 cursor-not-allowed' : ''}`}
                />
                <span className="text-[10px] text-gray-400">-1 for no limit</span>
            </div>

             {/* Max Video Preview */}
             <div>
                <label className="block text-xs font-medium text-gray-500 mb-1">Video Preview (sec)</label>
                <input 
                    type="number" 
                    value={settings[`${readPrefix}max_video_preview`] ?? -1}
                    onChange={(e) => handleInputChange('max_video_preview', e.target.value)}
                    disabled={isInputDisabled}
                    className={`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm dark:bg-gray-700 dark:text-white ${isInputDisabled ? 'bg-gray-100 dark:bg-gray-800 cursor-not-allowed' : ''}`}
                />
                <span className="text-[10px] text-gray-400">-1 for no limit</span>
            </div>

            {/* Max Image Preview */}
            <div>
                <label className="block text-xs font-medium text-gray-500 mb-1">Image Preview</label>
                <select 
                    value={settings[`${readPrefix}max_image_preview`] ?? 'large'}
                    onChange={(e) => handleInputChange('max_image_preview', e.target.value)}
                    disabled={isInputDisabled}
                    className={`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm dark:bg-gray-700 dark:text-white ${isInputDisabled ? 'bg-gray-100 dark:bg-gray-800 cursor-not-allowed' : ''}`}
                >
                    <option value="large">Large</option>
                    <option value="standard">Standard</option>
                    <option value="none">None</option>
                </select>
            </div>
        </div>
      </div>
    </div>
  );
};

export default AdvancedRobotsRow;