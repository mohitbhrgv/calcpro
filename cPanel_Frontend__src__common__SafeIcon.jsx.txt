import React from "react";
import * as FiIcons from "react-icons/fi";
import * as HiIcons from "react-icons/hi";
import * as IoIcons from "react-icons/io5";
import * as BiIcons from "react-icons/bi";
import * as AiIcons from "react-icons/ai";

const SafeIcon = ({ icon, name, ...props }) => {
  let IconComponent;

  try {
    // If icon is provided directly
    if (icon) {
      IconComponent = icon;
    }
    // If name is provided with library prefix
    else if (name) {
      const [library, iconName] = name.includes(":")
        ? name.split(":")
        : ["Fi", name];

      let iconLib;
      switch (library) {
        case "Fi":
          iconLib = FiIcons;
          break;
        case "Hi":
          iconLib = HiIcons;
          break;
        case "Io":
          iconLib = IoIcons;
          break;
        case "Bi":
          iconLib = BiIcons;
          break;
        case "Ai":
          iconLib = AiIcons;
          break;
        default:
          iconLib = FiIcons;
      }

      IconComponent = iconLib[`${library}${iconName}`] || iconLib[iconName];
    }
  } catch (e) {
    IconComponent = null;
    console.error("Icon not found:", name || icon);
  }

  return IconComponent ? (
    React.createElement(IconComponent, props)
  ) : (
    <IoIcons.IoAlertCircleOutline {...props} />
  );
};

export default SafeIcon;
